{% import "elements.html.twig" as c %}

<div {{ attributes }}>
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Add Document to Project</h2>

    <div class="mb-4">
        <input
            class="{{ c._input('w-full') }}"
            type="text"
            data-model="debounce(150)|search"
            placeholder="Search documents..."
            autofocus
        >
    </div>

    <div class="max-h-80 overflow-y-auto space-y-2">
        {% for document in this.documents %}
            {% set isAlreadyAdded = project and project.hasDocument(document) %}
            <div class="flex items-center justify-between p-3 rounded-lg border border-gray-200 hover:bg-gray-50 {{ isAlreadyAdded ? 'bg-gray-50' : '' }}">
                <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2">
                        <span class="font-medium text-gray-900 truncate">{{ document.name }}</span>
                        {% if document.currentVersion %}
                            <span class="text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded">
                                v{{ document.currentVersion.versionNumber }}
                            </span>
                        {% endif %}
                    </div>
                    {% if document.tags|length > 0 %}
                        <div class="flex flex-wrap gap-1 mt-1">
                            {% for tag in document.tags %}
                                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
                                    {{ tag.name }}
                                </span>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="ml-3 shrink-0">
                    {% if isAlreadyAdded %}
                        <span class="text-sm text-gray-400">Added</span>
                    {% else %}
                        <button
                            type="button"
                            class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors cursor-pointer"
                            data-action="live#action"
                            data-live-action-param="addDocument"
                            data-live-document-id-param="{{ document.id }}"
                        >
                            <twig:ux:icon name="tabler:plus" class="w-5 h-5" />
                        </button>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <div class="text-center py-8 text-gray-500">
                {% if search %}
                    No documents found matching "{{ search }}".
                {% else %}
                    No documents available.
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
